## 📄 Requirements Specification – *GreatShield*

---

### 1. **Document Purpose**

이 문서는 GreatShield 확장 프로그램의 기능 및 비기능 요구사항을 명시하여, 개발자, 테스트 엔지니어, 문서 담당자 등 프로젝트 참여자들에게 일관된 구현 지침을 제공하기 위함이다.

---

### 2. **System Overview**

GreatShield는 사용자가 PDF, DOCX, ZIP 등의 문서를 브라우저에서 다운로드할 때 이를 가로채어 로컬 정적 분석을 수행하는 **경량 크롬 확장형 백신 시스템**이다.
단순 시그니처 매칭 기반으로 빠른 위협 탐지를 수행하며, 향후 클라우드 분석 기능을 연동할 수 있도록 Stub 아키텍처도 포함한다.

---

### 3. **Functional Requirements (기능 요구사항)**

#### 3.1. **다운로드 이벤트 감지**

* F1.1: 브라우저의 `chrome.downloads.onCreated` 이벤트를 통해 다운로드 시작을 감지한다.
* F1.2: `onChanged` 및 `onDeterminingFilename` 이벤트를 통해 파일 확장자 및 경로를 확보한다.

#### 3.2. **파일 유형 판별 및 필터링**

* F2.1: `.pdf`, `.docx`, `.xlsx`, `.pptx`, `.zip` 파일만 스캔 대상으로 인정한다.
* F2.2: 확장자가 허용 리스트에 없거나, 파일 크기가 정책을 초과할 경우 스캔을 건너뛴다.

#### 3.3. **정적 스캔 및 룰 매칭**

* F3.1: PDF.js 등 파서 기반 모듈을 사용하여 문서 내용을 분석한다.
* F3.2: 악성 코드 패턴은 미리 정의된 정규식 시그니처로 탐지한다.
* F3.3: 탐지된 경우 다운로드를 차단하거나 사용자에게 경고 메시지를 띄운다.

#### 3.4. **알림 및 사용자 인터페이스**

* F4.1: 다운로드 결과(정상/위험 여부)를 Toast 알림으로 표시한다.
* F4.2: 클릭 시 검사 결과 요약 정보를 표시하는 간단한 팝업 UI를 제공한다.

#### 3.5. **스캔 결과 캐싱**

* F5.1: 최근 검사한 파일 해시 및 결과를 IndexedDB에 캐싱한다.
* F5.2: 동일 파일 재다운로드 시 캐시된 결과를 우선 참조한다.

#### 3.6. **Stub: Tier 2 에스컬레이션**

* F6.1: 위험 파일 탐지 시 Tier 2 샌드박스 전송 흐름은 Stub 함수로 처리한다.
* F6.2: 실제 샌드박스 업로드는 Phase 1에서 구현하지 않음.

---

### 4. **Non-Functional Requirements (비기능 요구사항)**

#### 4.1. **성능**

* N1.1: 평균 스캔 지연 시간은 50ms 이하여야 한다.
* N1.2: 확장 실행 중 메모리 점유율은 5MB 이하로 유지되어야 한다.

#### 4.2. **테스트 커버리지**

* N2.1: 단위 테스트 커버리지는 90% 이상 확보해야 한다 (Jest 기반).
* N2.2: 사용자 플로우 기준 E2E 테스트를 최소 5개 이상 작성해야 한다 (Playwright 기반).

#### 4.3. **보안**

* N3.1: 스캔 결과와 캐시 데이터는 XSS/CSRF 등 보안 취약점으로부터 보호되어야 한다.
* N3.2: 확장 프로그램 권한은 최소한의 범위(`downloads`, `storage`, `notifications`)로 제한해야 한다.

#### 4.4. **호환성**

* N4.1: 최신 버전의 Chrome 브라우저 (v120 이상)에서 정상 작동해야 한다.
* N4.2: 타 브라우저(Edge, Firefox 등)는 Phase 1에서 지원하지 않는다.

#### 4.5. **배포**

* N5.1: Chrome Web Store 제출을 위한 `manifest.json` 포맷은 `manifest_version: 3`이어야 한다.
* N5.2: 배포 빌드는 Webpack으로 번들링되며 `dist/` 디렉토리에 저장된다.

---

### 5. **Dependencies**

* PDF.js: PDF 구조 파싱용
* TypeScript: 정적 타입 기반 안전한 개발
* Chrome Extension API (Downloads, Notifications, Storage)
* Jest & Playwright: 테스트 프레임워크
* Webpack: 번들링 및 배포용

---

### 6. **Out of Scope (Phase 1 기준)**

* 동적 분석 기능 (Runtime sandboxing)
* 서버 기반 위협 인텔리전스 연동
* 사용자 통계/로그 서버 전송
* 자동 업데이트 기능
